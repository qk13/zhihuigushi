<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>çº¯å‰ç«¯AIè§†é¢‘ç”Ÿæˆå¹³å°</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary-color: #FF6B00;
      --primary-gradient: linear-gradient(135deg, #FF6B00 0%, #FF8C42 100%);
      --secondary-color: #4A90E2;
      --secondary-gradient: linear-gradient(135deg, #4A90E2 0%, #6AB0FF 100%);
      --dark-bg: #0F172A;
      --card-bg: rgba(255, 255, 255, 0.1);
      --card-hover: rgba(255, 255, 255, 0.15);
      --text-light: #F8FAFC;
      --text-muted: #94A3B8;
      --success-color: #10B981;
      --warning-color: #F59E0B;
      --danger-color: #EF4444;
      --border-radius: 16px;
      --shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * {
      box-sizing: border-box;
    }

    body {
      background: var(--dark-bg);
      color: var(--text-light);
      font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
      min-height: 100vh;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }

    /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--primary-color);
      border-radius: 4px;
    }

    /* ä¸»å®¹å™¨ */
    .main-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
      animation: fadeIn 0.8s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ç»ç’ƒæ€æ•ˆæœ */
    .glass-effect {
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: var(--shadow);
    }

    /* å¤´éƒ¨ */
    .main-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 0;
      margin-bottom: 30px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .logo {
      width: 50px;
      height: 50px;
      background: var(--primary-gradient);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      box-shadow: 0 4px 20px rgba(255, 107, 0, 0.4);
    }

    .brand-text {
      font-size: 28px;
      font-weight: 800;
      background: linear-gradient(90deg, #FF6B00, #FFA500);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      letter-spacing: -0.5px;
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .coin-badge {
      background: var(--secondary-gradient);
      padding: 10px 20px;
      border-radius: 50px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
      transition: var(--transition);
    }

    .coin-badge:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
    }

    /* æŒ‰é’®æ ·å¼ */
    .btn {
      padding: 12px 28px;
      border: none;
      border-radius: 50px;
      font-weight: 600;
      font-size: 16px;
      cursor: pointer;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      white-space: nowrap;
    }

    .btn-primary {
      background: var(--primary-gradient);
      color: white;
      box-shadow: 0 4px 15px rgba(255, 107, 0, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(255, 107, 0, 0.4);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: translateY(-2px);
    }

    /* AIç”ŸæˆåŒºåŸŸ */
    .ai-generator {
      background: var(--card-bg);
      backdrop-filter: blur(12px);
      border-radius: var(--border-radius);
      padding: 40px;
      margin: 40px 0;
      border: 1px solid rgba(255, 255, 255, 0.1);
      position: relative;
      overflow: hidden;
    }

    .ai-generator::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255, 107, 0, 0.1) 0%, transparent 70%);
      z-index: -1;
    }

    .generator-header {
      margin-bottom: 30px;
    }

    .generator-header h2 {
      font-size: 32px;
      margin-bottom: 10px;
      background: linear-gradient(90deg, #FF6B00, #FFA500);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .generator-header p {
      color: var(--text-muted);
      font-size: 18px;
    }

    .prompt-input-wrapper {
      position: relative;
      margin-bottom: 20px;
    }

    #aiPrompt {
      width: 100%;
      padding: 22px 25px;
      background: rgba(0, 0, 0, 0.3);
      border: 2px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      color: white;
      font-size: 18px;
      transition: var(--transition);
    }

    #aiPrompt:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(255, 107, 0, 0.2);
    }

    .prompt-examples {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 15px;
    }

    .example-tag {
      padding: 8px 16px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 50px;
      font-size: 14px;
      color: var(--text-muted);
      cursor: pointer;
      transition: var(--transition);
    }

    .example-tag:hover {
      background: rgba(255, 107, 0, 0.2);
      color: white;
    }

    .generator-controls {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .cost-badge {
      display: flex;
      align-items: center;
      gap: 8px;
      background: rgba(255, 255, 255, 0.05);
      padding: 12px 20px;
      border-radius: 50px;
    }

    /* åŠ è½½åŠ¨ç”» */
    .loading {
      text-align: center;
      padding: 40px;
      display: none;
    }

    .ai-spinner {
      width: 70px;
      height: 70px;
      border: 4px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      border-top-color: var(--primary-color);
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* è§†é¢‘é¢„è§ˆ */
    .ai-video-preview {
      margin-top: 30px;
      border-radius: var(--border-radius);
      overflow: hidden;
      display: none;
      animation: slideUp 0.5s ease-out;
    }

    @keyframes slideUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* è§†é¢‘ç½‘æ ¼ */
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 50px 0 25px;
    }

    .section-header h3 {
      font-size: 24px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .video-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 25px;
      margin-bottom: 50px;
    }

    .video-card {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      overflow: hidden;
      transition: var(--transition);
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .video-card:hover {
      transform: translateY(-10px);
      background: var(--card-hover);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
    }

    .thumbnail-container {
      position: relative;
      overflow: hidden;
      height: 200px;
    }

    .thumbnail {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
    }

    .video-card:hover .thumbnail {
      transform: scale(1.05);
    }

    .play-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .video-card:hover .play-overlay {
      opacity: 1;
    }

    .play-icon {
      width: 60px;
      height: 60px;
      background: var(--primary-color);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      color: white;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }

    .video-info {
      padding: 20px;
    }

    .video-info h4 {
      margin: 0 0 10px;
      font-size: 18px;
      font-weight: 600;
    }

    .video-info p {
      color: var(--text-muted);
      font-size: 14px;
      margin: 0 0 15px;
    }

    .video-meta {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      color: var(--text-muted);
    }

    /* ä¸ªäººç©ºé—´ */
    .personal-section {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 40px;
      margin: 40px 0;
      display: none;
      animation: fadeIn 0.5s ease;
    }

    .section-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }

    .account-info {
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--border-radius);
      padding: 25px;
      margin-bottom: 30px;
    }

    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
    }

    .info-item {
      padding: 15px;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 12px;
    }

    .info-label {
      font-size: 14px;
      color: var(--text-muted);
      margin-bottom: 5px;
    }

    .info-value {
      font-size: 24px;
      font-weight: 700;
      color: white;
    }

    .recharge-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .recharge-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--border-radius);
      padding: 25px;
      text-align: center;
      cursor: pointer;
      transition: var(--transition);
      border: 2px solid transparent;
    }

    .recharge-card:hover {
      background: rgba(255, 107, 0, 0.1);
      border-color: var(--primary-color);
      transform: translateY(-5px);
    }

    .recharge-card.highlight {
      background: rgba(255, 107, 0, 0.15);
      border-color: var(--primary-color);
      position: relative;
      overflow: hidden;
    }

    .recharge-card.highlight::before {
      content: 'æ¨è';
      position: absolute;
      top: 10px;
      right: -25px;
      background: var(--primary-color);
      color: white;
      padding: 3px 30px;
      font-size: 12px;
      font-weight: 600;
      transform: rotate(45deg);
    }

    .coin-amount {
      font-size: 32px;
      font-weight: 800;
      color: var(--primary-color);
      margin: 10px 0;
    }

    .coin-price {
      font-size: 18px;
      color: var(--text-muted);
    }

    .coin-savings {
      font-size: 14px;
      color: var(--success-color);
      margin-top: 5px;
    }

    /* å¼¹çª— */
    .auth-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(15, 23, 42, 0.9);
      backdrop-filter: blur(10px);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .auth-container {
      width: 100%;
      max-width: 450px;
      background: var(--dark-bg);
      border-radius: var(--border-radius);
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      animation: modalSlide 0.4s ease-out;
    }

    @keyframes modalSlide {
      from { transform: translateY(30px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .auth-header {
      padding: 30px;
      text-align: center;
      background: rgba(255, 107, 0, 0.1);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .auth-header h3 {
      font-size: 24px;
      margin: 0;
      background: linear-gradient(90deg, #FF6B00, #FFA500);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .auth-tabs {
      display: flex;
      background: rgba(255, 255, 255, 0.05);
    }

    .auth-tab {
      flex: 1;
      padding: 18px;
      text-align: center;
      cursor: pointer;
      font-weight: 600;
      color: var(--text-muted);
      transition: var(--transition);
      border-bottom: 3px solid transparent;
    }

    .auth-tab.active {
      color: white;
      border-bottom-color: var(--primary-color);
      background: rgba(255, 107, 0, 0.1);
    }

    .auth-form {
      padding: 30px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--text-light);
    }

    .form-input {
      width: 100%;
      padding: 15px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      color: white;
      font-size: 16px;
      transition: var(--transition);
    }

    .form-input:focus {
      outline: none;
      border-color: var(--primary-color);
      background: rgba(255, 255, 255, 0.08);
    }

    /* é€šçŸ¥ */
    .notification {
      position: fixed;
      top: 25px;
      right: 25px;
      padding: 18px 25px;
      border-radius: var(--border-radius);
      background: rgba(16, 185, 129, 0.95);
      backdrop-filter: blur(10px);
      color: white;
      font-weight: 600;
      z-index: 10000;
      animation: slideInRight 0.3s ease;
      box-shadow: var(--shadow);
      max-width: 350px;
      border-left: 4px solid var(--success-color);
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .notification.error {
      background: rgba(239, 68, 68, 0.95);
      border-left-color: var(--danger-color);
    }

    .notification.warning {
      background: rgba(245, 158, 11, 0.95);
      border-left-color: var(--warning-color);
    }

    @keyframes slideInRight {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    /* è§†é¢‘æ’­æ”¾å™¨ */
    .video-player-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 1001;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.3s ease;
    }

    .video-player {
      width: 90%;
      max-width: 1200px;
      position: relative;
    }

    .close-player {
      position: absolute;
      top: -50px;
      right: 0;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
    }

    .close-player:hover {
      background: var(--primary-color);
    }

    .video-player video {
      width: 100%;
      border-radius: var(--border-radius);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    }

    /* å“åº”å¼ */
    @media (max-width: 768px) {
      .main-header {
        flex-direction: column;
        gap: 20px;
        text-align: center;
      }
      
      .video-grid {
        grid-template-columns: 1fr;
      }
      
      .ai-generator,
      .personal-section {
        padding: 25px;
      }
      
      .generator-controls {
        flex-direction: column;
        align-items: stretch;
      }
      
      .cost-badge {
        justify-content: center;
      }
      
      .recharge-grid {
        grid-template-columns: 1fr;
      }
    }

    /* åº•éƒ¨ */
    .footer {
      text-align: center;
      padding: 30px;
      margin-top: 50px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      color: var(--text-muted);
      font-size: 14px;
    }

    /* ç²’å­èƒŒæ™¯ */
    .particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      pointer-events: none;
    }
    
    /* è§†é¢‘ä¸Šä¼ åŒºåŸŸ */
    .upload-area {
      background: rgba(255, 255, 255, 0.05);
      border: 2px dashed rgba(255, 255, 255, 0.2);
      border-radius: var(--border-radius);
      padding: 40px;
      text-align: center;
      cursor: pointer;
      transition: var(--transition);
      margin-bottom: 30px;
    }
    
    .upload-area:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: var(--primary-color);
    }
    
    .upload-icon {
      font-size: 48px;
      color: var(--primary-color);
      margin-bottom: 15px;
    }
    
    /* AIç”Ÿæˆæ­¥éª¤ */
    .process-step {
      margin: 10px 0;
      padding: 8px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
    }
    
    .ai-generated-info {
      margin-top: 15px;
      padding: 15px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: var(--border-radius);
    }
    
    /* è§†é¢‘é”™è¯¯æç¤º */
    .video-error {
      text-align: center;
      padding: 40px;
      color: var(--text-muted);
    }
    
    .video-error i {
      font-size: 48px;
      margin-bottom: 15px;
      color: var(--danger-color);
    }
  </style>
</head>
<body>
  <!-- ç²’å­èƒŒæ™¯ -->
  <div class="particles" id="particles"></div>

  <!-- ç™»å½•æ³¨å†Œå¼¹çª— -->
  <div class="auth-modal" id="authModal">
    <div class="auth-container">
      <div class="auth-header">
        <h3><i class="fas fa-video"></i> AIè§†é¢‘å¹³å°</h3>
        <p style="color: var(--text-muted); margin-top: 10px;">ç™»å½•æˆ–æ³¨å†Œå¼€å§‹åˆ›ä½œ</p>
      </div>
      
      <div class="auth-tabs">
        <div class="auth-tab active" onclick="switchAuthTab('login')">
          <i class="fas fa-sign-in-alt"></i> ç™»å½•
        </div>
        <div class="auth-tab" onclick="switchAuthTab('register')">
          <i class="fas fa-user-plus"></i> æ³¨å†Œ
        </div>
      </div>
      
      <div class="auth-form" id="loginForm">
        <div class="form-group">
          <label class="form-label">ç”¨æˆ·å</label>
          <input type="text" id="loginUsername" class="form-input" placeholder="è¯·è¾“å…¥ç”¨æˆ·å">
        </div>
        <div class="form-group">
          <label class="form-label">å¯†ç </label>
          <input type="password" id="loginPassword" class="form-input" placeholder="è¯·è¾“å…¥å¯†ç ">
        </div>
        <button class="btn btn-primary" onclick="login()" style="width: 100%;">
          <i class="fas fa-sign-in-alt"></i> ç«‹å³ç™»å½•
        </button>
        <p style="text-align: center; margin-top: 20px; color: var(--text-muted); font-size: 14px;">
          <i class="fas fa-lightbulb"></i> æµ‹è¯•è´¦å·: test / 123456
        </p>
      </div>
      
      <div class="auth-form" id="registerForm" style="display: none;">
        <div class="form-group">
          <label class="form-label">ç”¨æˆ·å</label>
          <input type="text" id="regUsername" class="form-input" placeholder="3-20ä½å­—æ¯æ•°å­—">
        </div>
        <div class="form-group">
          <label class="form-label">å¯†ç </label>
          <input type="password" id="regPassword" class="form-input" placeholder="è‡³å°‘6ä½å­—ç¬¦">
        </div>
        <div class="form-group">
          <label class="form-label">ç¡®è®¤å¯†ç </label>
          <input type="password" id="regConfirmPassword" class="form-input" placeholder="å†æ¬¡è¾“å…¥å¯†ç ">
        </div>
        <button class="btn btn-primary" onclick="register()" style="width: 100%;">
          <i class="fas fa-user-plus"></i> ç«‹å³æ³¨å†Œ
        </button>
      </div>
    </div>
  </div>

  <!-- ä¸»ç•Œé¢ -->
  <div class="main-container" id="mainContainer">
    <!-- å¤´éƒ¨ -->
    <div class="main-header">
      <div class="brand">
        <div class="logo">
          <i class="fas fa-video"></i>
        </div>
        <div class="brand-text">AIè§†é¢‘ç”Ÿæˆå¹³å°</div>
      </div>
      
      <div class="user-info">
        <div class="coin-badge">
          <i class="fas fa-coins"></i>
          <span id="coinsDisplay">0</span> ç”Ÿæˆå¸
        </div>
        <div id="usernameDisplay" style="font-weight: 600;">æ¸¸å®¢</div>
        <button class="btn btn-secondary" onclick="showAuthModal()" id="loginBtn">
          <i class="fas fa-sign-in-alt"></i> ç™»å½•
        </button>
        <button class="btn btn-secondary" onclick="showPersonal()" id="personalBtn" style="display:none;">
          <i class="fas fa-user"></i> ä¸ªäººä¸­å¿ƒ
        </button>
        <button class="btn btn-secondary" onclick="logout()" id="logoutBtn" style="display:none;">
          <i class="fas fa-sign-out-alt"></i> é€€å‡º
        </button>
      </div>
    </div>

    <!-- AIç”Ÿæˆå™¨ -->
    <div class="ai-generator glass-effect">
      <div class="generator-header">
        <h2><i class="fas fa-magic"></i> AIæ™ºèƒ½è§†é¢‘ç”Ÿæˆ</h2>
        <p>è¾“å…¥æè¿°ï¼ŒAIå°†æ™ºèƒ½åŒ¹é…é«˜è´¨é‡è§†é¢‘ç´ æï¼Œçº¯å‰ç«¯å¤„ç†æ— éœ€ç­‰å¾…</p>
      </div>
      
      <div class="prompt-input-wrapper">
        <input type="text" id="aiPrompt" placeholder="è¯·æè¿°æ‚¨æƒ³è¦çš„è§†é¢‘å†…å®¹...">
        <div class="prompt-examples">
          <div class="example-tag" onclick="setPrompt('åŠ¨ç”»ç”µå½±ï¼Œå¯çˆ±åŠ¨ç‰©å†’é™©æ•…äº‹')">åŠ¨ç”»ç”µå½±</div>
          <div class="example-tag" onclick="setPrompt('è‡ªç„¶é£å…‰ï¼Œå±±æ°´å¦‚ç”»çš„é£æ™¯')">è‡ªç„¶é£å…‰</div>
          <div class="example-tag" onclick="setPrompt('æœªæ¥åŸå¸‚ï¼Œç§‘æŠ€æ„Ÿåè¶³çš„å»ºç­‘')">æœªæ¥åŸå¸‚</div>
          <div class="example-tag" onclick="setPrompt('åŠ¨ç‰©ä¸–ç•Œï¼Œå¯çˆ±å® ç‰©æ—¥å¸¸')">åŠ¨ç‰©ä¸–ç•Œ</div>
        </div>
      </div>
      
      <div class="generator-controls">
        <div class="cost-badge">
          <i class="fas fa-coins" style="color: var(--warning-color);"></i>
          <span>æ¶ˆè€—: <strong>10</strong> ç”Ÿæˆå¸</span>
        </div>
        <button class="btn btn-primary" onclick="generateAIVideo()">
          <i class="fas fa-play-circle"></i> ç”Ÿæˆè§†é¢‘
        </button>
      </div>
      
      <!-- åŠ è½½çŠ¶æ€ -->
      <div class="loading" id="loading">
        <div class="ai-spinner"></div>
        <h3>AIæ­£åœ¨æ™ºèƒ½åŒ¹é…è§†é¢‘...</h3>
        <p style="color: var(--text-muted);">æ­£åœ¨åˆ†ææ‚¨çš„æè¿°å¹¶åŒ¹é…æœ€ä½³è§†é¢‘ç´ æ</p>
        <div id="aiProcessSteps" style="margin-top: 20px; text-align: left; max-width: 400px; margin: 20px auto;">
          <div class="process-step">
            <i class="fas fa-search" style="color: var(--primary-color); margin-right: 10px;"></i>
            <span>è§£æå…³é”®è¯: <span id="step1">æ­£åœ¨åˆ†æ...</span></span>
          </div>
          <div class="process-step">
            <i class="fas fa-brain" style="color: var(--primary-color); margin-right: 10px;"></i>
            <span>æ™ºèƒ½åŒ¹é…: <span id="step2">æ­£åœ¨åŒ¹é…...</span></span>
          </div>
          <div class="process-step">
            <i class="fas fa-film" style="color: var(--primary-color); margin-right: 10px;"></i>
            <span>è§†é¢‘ç”Ÿæˆ: <span id="step3">æ­£åœ¨ç”Ÿæˆ...</span></span>
          </div>
        </div>
      </div>
      
      <!-- è§†é¢‘é¢„è§ˆ -->
      <div class="ai-video-preview" id="aiVideoPreview">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
          <h4 style="margin: 0;"><i class="fas fa-film"></i> AIç”Ÿæˆçš„è§†é¢‘</h4>
          <div style="background: rgba(255,107,0,0.2); color: var(--primary-color); padding: 5px 15px; border-radius: 20px; font-size: 14px;">
            <i class="fas fa-tag"></i> <span id="aiVideoCategory">æœªçŸ¥åˆ†ç±»</span>
          </div>
        </div>
        <div id="aiVideoContainer">
          <video id="aiGeneratedVideo" controls style="width: 100%; border-radius: var(--border-radius);">
            æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾
          </video>
        </div>
        <div class="ai-generated-info">
          <div style="font-weight: 600; margin-bottom: 10px; color: var(--primary-color);">
            <i class="fas fa-info-circle"></i> ç”Ÿæˆä¿¡æ¯
          </div>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 14px;">
            <div>
              <span style="color: var(--text-muted);">åŒ¹é…å…³é”®è¯:</span>
              <span id="aiMatchedKeywords" style="margin-left: 10px; font-weight: 600;"></span>
            </div>
            <div>
              <span style="color: var(--text-muted);">è§†é¢‘æ—¶é•¿:</span>
              <span id="aiVideoDuration" style="margin-left: 10px; font-weight: 600;"></span>
            </div>
            <div>
              <span style="color: var(--text-muted);">ç”Ÿæˆæ—¶é—´:</span>
              <span id="aiGeneratedTime" style="margin-left: 10px; font-weight: 600;"></span>
            </div>
            <div>
              <span style="color: var(--text-muted);">æ¶ˆè€—:</span>
              <span style="margin-left: 10px; font-weight: 600; color: var(--warning-color);">10 ç”Ÿæˆå¸</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- æœ¬åœ°è§†é¢‘ä¸Šä¼  -->
    <div class="upload-area" onclick="addLocalVideo()" id="uploadArea">
      <div class="upload-icon">
        <i class="fas fa-cloud-upload-alt"></i>
      </div>
      <h3>ç‚¹å‡»ä¸Šä¼ æœ¬åœ°è§†é¢‘</h3>
      <p style="color: var(--text-muted); margin-bottom: 15px;">æ”¯æŒMP4ã€WebMã€MOVæ ¼å¼ï¼Œæœ€å¤§100MB</p>
      <button class="btn btn-secondary">
        <i class="fas fa-plus"></i> æ·»åŠ æœ¬åœ°è§†é¢‘
      </button>
    </div>

    <!-- æœ¬åœ°è§†é¢‘åº“ -->
    <div class="section-header">
      <h3><i class="fas fa-video"></i> æœ¬åœ°è§†é¢‘åº“</h3>
      <div>
        <button class="btn btn-secondary" onclick="addLocalVideo()" style="margin-right:10px;">
          <i class="fas fa-upload"></i> ä¸Šä¼ è§†é¢‘
        </button>
        <button class="btn btn-secondary" onclick="refreshVideos()">
          <i class="fas fa-sync-alt"></i> åˆ·æ–°åˆ—è¡¨
        </button>
      </div>
    </div>
    
    <div class="video-grid" id="videoGrid">
      <!-- è§†é¢‘å¡ç‰‡å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
    </div>

    <!-- ä¸ªäººç©ºé—´ -->
    <div class="personal-section" id="personalSection">
      <div class="section-nav">
        <h3><i class="fas fa-user-circle"></i> ä¸ªäººä¸­å¿ƒ</h3>
        <button class="btn btn-secondary" onclick="hidePersonal()">
          <i class="fas fa-arrow-left"></i> è¿”å›é¦–é¡µ
        </button>
      </div>
      
      <div class="account-info">
        <h4 style="margin-bottom: 20px;"><i class="fas fa-info-circle"></i> è´¦æˆ·ä¿¡æ¯</h4>
        <div class="info-grid">
          <div class="info-item">
            <div class="info-label">ç”¨æˆ·å</div>
            <div class="info-value" id="accountUsername">-</div>
          </div>
          <div class="info-item">
            <div class="info-label">ç”Ÿæˆå¸ä½™é¢</div>
            <div class="info-value" id="accountCoins">0</div>
          </div>
          <div class="info-item">
            <div class="info-label">æ³¨å†Œæ—¥æœŸ</div>
            <div class="info-value" id="accountDate">-</div>
          </div>
          <div class="info-item">
            <div class="info-label">å·²ç”Ÿæˆè§†é¢‘</div>
            <div class="info-value" id="generatedVideos">0</div>
          </div>
        </div>
      </div>
      
      <div>
        <h4 style="margin-bottom: 20px;"><i class="fas fa-coins"></i> ç”Ÿæˆå¸å……å€¼</h4>
        <p style="color: var(--text-muted); margin-bottom: 20px;">é€‰æ‹©å¥—é¤å……å€¼ç”Ÿæˆå¸ï¼Œå¼€å§‹æ‚¨çš„åˆ›ä½œä¹‹æ—…</p>
        
        <div class="recharge-grid">
          <div class="recharge-card" onclick="addCoins(10)">
            <div style="font-size: 14px; color: var(--text-muted);">åŸºç¡€å¥—é¤</div>
            <div class="coin-amount">10å¸</div>
            <div class="coin-price">Â¥10.00</div>
            <div class="coin-savings">é€‚åˆå°é²œä½“éªŒ</div>
          </div>
          
          <div class="recharge-card highlight" onclick="addCoins(50)">
            <div style="font-size: 14px; color: var(--text-muted);">è¶…å€¼å¥—é¤</div>
            <div class="coin-amount">50å¸</div>
            <div class="coin-price">Â¥45.00</div>
            <div class="coin-savings">èŠ‚çœ Â¥5.00</div>
          </div>
          
          <div class="recharge-card" onclick="addCoins(100)">
            <div style="font-size: 14px; color: var(--text-muted);">ä¸“ä¸šå¥—é¤</div>
            <div class="coin-amount">100å¸</div>
            <div class="coin-price">Â¥80.00</div>
            <div class="coin-savings">èŠ‚çœ Â¥20.00</div>
          </div>
        </div>
      </div>
    </div>

    <!-- åº•éƒ¨ -->
    <div class="footer">
      <p>çº¯å‰ç«¯AIè§†é¢‘ç”Ÿæˆå¹³å° | æ”¯æŒæœ¬åœ°è§†é¢‘ä¸Šä¼  | å®Œå…¨åœ¨æµè§ˆå™¨ä¸­è¿è¡Œ</p>
      <p style="margin-top: 10px; font-size: 12px;">
        <i class="fas fa-code"></i> åŸºäºHTML5/CSS3/JavaScript | 
        <i class="fas fa-video"></i> æ”¯æŒæœ¬åœ°MP4è§†é¢‘æ–‡ä»¶
      </p>
    </div>
  </div>

  <!-- è§†é¢‘æ’­æ”¾å™¨ -->
  <div class="video-player-overlay" id="videoPlayer">
    <div class="video-player">
      <button class="close-player" onclick="closeVideo()">
        <i class="fas fa-times"></i>
      </button>
      <video id="playerVideo" controls>
        <source src="" type="video/mp4">
      </video>
    </div>
  </div>

  <script>
    // ==================== å…¨å±€å˜é‡ ====================
    let currentUser = null;
    let userDatabase = JSON.parse(localStorage.getItem('videoUsers')) || {};
    let generatedVideosCount = JSON.parse(localStorage.getItem('generatedVideos')) || {};
    
    // AIè§†é¢‘ç”Ÿæˆåº“
    const aiVideoLibrary = {
      'åŠ¨ç”»': [
        {
          title: 'æ¢¦å¹»åŠ¨ç”»ä¸–ç•Œ',
          desc: 'å……æ»¡æƒ³è±¡åŠ›çš„åŠ¨ç”»åœºæ™¯ï¼Œè‰²å½©ç»šä¸½',
          duration: '02:45',
          category: 'åŠ¨ç”»',
          keywords: ['åŠ¨ç”»', 'å¡é€š', 'åŠ¨æ¼«', 'å¹»æƒ³', 'ç«¥è¯'],
          // ä½¿ç”¨å¯é çš„è§†é¢‘æº
          url: 'https://storage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4'
        },
        {
          title: 'å¡é€šåŠ¨ç‰©å¤§å†’é™©',
          desc: 'å¯çˆ±çš„å¡é€šåŠ¨ç‰©åœ¨å¥‡å¹»ä¸–ç•Œå†’é™©',
          duration: '03:20',
          category: 'åŠ¨ç”»',
          keywords: ['åŠ¨ç‰©', 'å†’é™©', 'å¡é€š', 'å¯çˆ±', 'å¥‡å¹»'],
          url: 'https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4'
        },
        {
          title: 'æœªæ¥ç§‘æŠ€åŠ¨ç”»',
          desc: 'å±•ç°æœªæ¥ç§‘æŠ€æ„Ÿçš„åŠ¨ç”»çŸ­ç‰‡',
          duration: '01:55',
          category: 'åŠ¨ç”»',
          keywords: ['æœªæ¥', 'ç§‘æŠ€', 'ç§‘å¹»', 'æœºæ¢°', 'æ•°å­—'],
          url: 'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4'
        }
      ],
      'è‡ªç„¶': [
        {
          title: 'å±±å·å£®ä¸½é£å…‰',
          desc: 'å£®ä¸½çš„è‡ªç„¶å±±è„‰å’Œæ¸…æ¾ˆçš„æºªæµ',
          duration: '04:10',
          category: 'è‡ªç„¶',
          keywords: ['è‡ªç„¶', 'é£æ™¯', 'å±±æ°´', 'å±±è„‰', 'æºªæµ'],
          url: 'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4'
        },
        {
          title: 'æ£®æ—ç§˜å¢ƒæ¢ç´¢',
          desc: 'ç¥ç§˜çš„æ£®æ—æ·±å¤„ï¼Œç”Ÿæœºå‹ƒå‹ƒçš„ç”Ÿæ€',
          duration: '03:45',
          category: 'è‡ªç„¶',
          keywords: ['æ£®æ—', 'æ ‘æœ¨', 'ç”Ÿæ€', 'ç»¿è‰²', 'ç§˜å¢ƒ'],
          url: 'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerMeltdowns.mp4'
        },
        {
          title: 'æµ·æ´‹å¥‡å¹»ä¸–ç•Œ',
          desc: 'ç¾ä¸½çš„æµ·åº•ä¸–ç•Œï¼Œå¤šå½©çš„æµ·æ´‹ç”Ÿç‰©',
          duration: '02:30',
          category: 'è‡ªç„¶',
          keywords: ['æµ·æ´‹', 'æµ·åº•', 'é±¼ç±»', 'çŠç‘š', 'è“è‰²'],
          url: 'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4'
        }
      ],
      'åŸå¸‚': [
        {
          title: 'éƒ½å¸‚å¤œæ™¯æµå…‰',
          desc: 'ç¹åéƒ½å¸‚çš„å¤œæ™šï¼Œç¯å…‰ç’€ç’¨',
          duration: '02:15',
          category: 'åŸå¸‚',
          keywords: ['åŸå¸‚', 'å¤œæ™¯', 'ç¯å…‰', 'å»ºç­‘', 'ç¹å'],
          url: 'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscapes.mp4'
        },
        {
          title: 'ç°ä»£å»ºç­‘å·¡ç¤¼',
          desc: 'ç°ä»£å»ºç­‘çš„çº¿æ¡ç¾ä¸ç©ºé—´æ„Ÿ',
          duration: '03:00',
          category: 'åŸå¸‚',
          keywords: ['å»ºç­‘', 'ç°ä»£', 'è®¾è®¡', 'çº¿æ¡', 'ç©ºé—´'],
          url: 'https://storage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4'
        },
        {
          title: 'åŸå¸‚ç”Ÿæ´»èŠ‚å¥',
          desc: 'å¿«èŠ‚å¥çš„åŸå¸‚ç”Ÿæ´»ä¸äººæ–‡æ°”æ¯',
          duration: '01:50',
          category: 'åŸå¸‚',
          keywords: ['ç”Ÿæ´»', 'äººæ–‡', 'èŠ‚å¥', 'éƒ½å¸‚', 'äººç¾¤'],
          url: 'https://storage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4'
        }
      ],
      'åŠ¨ç‰©': [
        {
          title: 'èŒå® æ—¥å¸¸åˆé›†',
          desc: 'å„ç§å¯çˆ±å® ç‰©çš„æœ‰è¶£æ—¥å¸¸',
          duration: '02:25',
          category: 'åŠ¨ç‰©',
          keywords: ['å® ç‰©', 'å¯çˆ±', 'èŒå® ', 'æ—¥å¸¸', 'å°çŒ«å°ç‹—'],
          url: 'https://storage.googleapis.com/gtv-videos-bucket/sample/SubaruOutbackOnStreetAndDirt.mp4'
        },
        {
          title: 'é‡ç”ŸåŠ¨ç‰©ä¸–ç•Œ',
          desc: 'é‡å¤–åŠ¨ç‰©çš„è‡ªç„¶ç”Ÿå­˜çŠ¶æ€',
          duration: '04:30',
          category: 'åŠ¨ç‰©',
          keywords: ['é‡ç”Ÿ', 'åŠ¨ç‰©', 'è‡ªç„¶', 'ç”Ÿæ€', 'é‡å¤–'],
          url: 'https://storage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4'
        },
        {
          title: 'é¸Ÿç±»é£ç¿”ä¹‹ç¾',
          desc: 'å„ç§é¸Ÿç±»åœ¨ç©ºä¸­ç¿±ç¿”çš„ç¾ä¸½ç”»é¢',
          duration: '03:10',
          category: 'åŠ¨ç‰©',
          keywords: ['é¸Ÿç±»', 'é£ç¿”', 'å¤©ç©º', 'è‡ªç”±', 'ç¿…è†€'],
          url: 'https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4'
        }
      ],
      'ç§‘æŠ€': [
        {
          title: 'æœªæ¥ç§‘æŠ€å±•ç¤º',
          desc: 'å‰æ²¿ç§‘æŠ€äº§å“çš„å±•ç¤ºä¸åº”ç”¨',
          duration: '02:40',
          category: 'ç§‘æŠ€',
          keywords: ['ç§‘æŠ€', 'æœªæ¥', 'æ™ºèƒ½', 'åˆ›æ–°', 'äº§å“'],
          url: 'https://storage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4'
        },
        {
          title: 'æ•°å­—è‰ºæœ¯ç©ºé—´',
          desc: 'æ•°å­—æŠ€æœ¯ä¸è‰ºæœ¯ç»“åˆçš„è§†è§‰ç››å®´',
          duration: '03:15',
          category: 'ç§‘æŠ€',
          keywords: ['æ•°å­—', 'è‰ºæœ¯', 'è§†è§‰', 'ç‰¹æ•ˆ', 'åˆ›æ„'],
          url: 'https://storage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4'
        },
        {
          title: 'äººå·¥æ™ºèƒ½æœªæ¥',
          desc: 'AIæŠ€æœ¯å‘å±•ä¸åº”ç”¨çš„æƒ³è±¡ç©ºé—´',
          duration: '02:55',
          category: 'ç§‘æŠ€',
          keywords: ['AI', 'äººå·¥æ™ºèƒ½', 'ç®—æ³•', 'æ•°æ®', 'æ™ºèƒ½'],
          url: 'https://storage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4'
        }
      ]
    };

    // å¤‡é€‰è§†é¢‘æºï¼ˆå¦‚æœä¸»æºæ— æ³•è®¿é—®ï¼‰
    const backupVideoSources = [
      'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4',
      'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',
      'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4',
      'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4',
      'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerMeltdowns.mp4'
    ];

    // æœ¬åœ°è§†é¢‘åº“
    const videoLibrary = {
      'æœ¬åœ°è§†é¢‘': [
        { 
          url: 'videos/æˆ‘çš„è§†é¢‘1.mp4',
          title: 'ç¾ä¸½çš„å±±æ°´é£æ™¯', 
          desc: 'å£®ä¸½çš„è‡ªç„¶å±±æ°´é£å…‰ï¼Œé«˜æ¸…ç”»è´¨',
          duration: '02:30',
          category: 'æœ¬åœ°è§†é¢‘',
          size: '25MB'
        },
        { 
          url: 'videos/æˆ‘çš„è§†é¢‘2.mp4',
          title: 'åŸå¸‚å¤œæ™¯å»¶æ—¶', 
          desc: 'ç¹åéƒ½å¸‚çš„å¤œæ™šç¯å…‰ç§€ï¼Œå»¶æ—¶æ‘„å½±',
          duration: '01:45',
          category: 'æœ¬åœ°è§†é¢‘',
          size: '18MB'
        }
      ]
    };
    
    // å­˜å‚¨ç”¨æˆ·ä¸Šä¼ çš„æœ¬åœ°è§†é¢‘
    let userLocalVideos = JSON.parse(localStorage.getItem('userLocalVideos')) || [];

    // ==================== å·¥å…·å‡½æ•° ====================
    function showNotification(message, type = 'success') {
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      
      let icon = 'fas fa-check-circle';
      if (type === 'error') icon = 'fas fa-exclamation-circle';
      if (type === 'warning') icon = 'fas fa-exclamation-triangle';
      
      notification.innerHTML = `
        <i class="${icon}"></i>
        <span>${message}</span>
      `;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.style.opacity = '0';
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => notification.remove(), 300);
      }, 3000);
    }

    // æ˜¾ç¤ºè§†é¢‘é”™è¯¯
    function showVideoError(message) {
      const videoContainer = document.getElementById('aiVideoContainer');
      videoContainer.innerHTML = `
        <div class="video-error">
          <i class="fas fa-video-slash"></i>
          <h4>è§†é¢‘åŠ è½½å¤±è´¥</h4>
          <p>${message}</p>
          <button class="btn btn-secondary" onclick="retryVideoLoad()" style="margin-top: 15px;">
            <i class="fas fa-redo"></i> é‡è¯•åŠ è½½
          </button>
        </div>
      `;
    }

    // é‡è¯•åŠ è½½è§†é¢‘
    function retryVideoLoad() {
      const videoContainer = document.getElementById('aiVideoContainer');
      const videoElement = document.getElementById('aiGeneratedVideo');
      
      if (videoElement && videoElement.src) {
        videoContainer.innerHTML = `<video id="aiGeneratedVideo" controls style="width: 100%; border-radius: var(--border-radius);"></video>`;
        document.getElementById('aiGeneratedVideo').src = videoElement.src;
        document.getElementById('aiGeneratedVideo').load();
      }
    }

    // ==================== ç”¨æˆ·ç³»ç»Ÿ ====================
    function showAuthModal() {
      document.getElementById('authModal').style.display = 'flex';
    }

    function hideAuthModal() {
      document.getElementById('authModal').style.display = 'none';
    }

    function switchAuthTab(tab) {
      document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
      document.getElementById(tab + 'Form').style.display = 'block';
      document.querySelector(`.auth-tab[onclick*="${tab}"]`).classList.add('active');
      document.querySelectorAll('.auth-form').forEach(f => {
        if(f.id !== tab + 'Form') f.style.display = 'none';
      });
    }

    function register() {
      const username = document.getElementById('regUsername').value.trim();
      const password = document.getElementById('regPassword').value;
      const confirmPassword = document.getElementById('regConfirmPassword').value;

      if (!username || !password || !confirmPassword) {
        showNotification('è¯·å¡«å†™æ‰€æœ‰ä¿¡æ¯', 'error');
        return;
      }

      if (username.length < 3 || username.length > 20) {
        showNotification('ç”¨æˆ·åé•¿åº¦ä¸º3-20ä½', 'error');
        return;
      }

      if (password.length < 6) {
        showNotification('å¯†ç è‡³å°‘6ä½', 'error');
        return;
      }

      if (password !== confirmPassword) {
        showNotification('ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´', 'error');
        return;
      }

      if (userDatabase[username]) {
        showNotification('ç”¨æˆ·åå·²å­˜åœ¨', 'error');
        return;
      }

      userDatabase[username] = {
        username: username,
        password: btoa(password),
        coins: 100,
        joinDate: new Date().toLocaleDateString('zh-CN'),
        generatedVideos: 0
      };

      generatedVideosCount[username] = 0;
      
      localStorage.setItem('videoUsers', JSON.stringify(userDatabase));
      localStorage.setItem('generatedVideos', JSON.stringify(generatedVideosCount));
      
      loginUser(username);
      hideAuthModal();
      showNotification('ğŸ‰ æ³¨å†ŒæˆåŠŸï¼èµ é€100ç”Ÿæˆå¸', 'success');
    }

    function login() {
      const username = document.getElementById('loginUsername').value.trim();
      const password = document.getElementById('loginPassword').value;

      if (!username || !password) {
        showNotification('è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ', 'error');
        return;
      }

      const user = userDatabase[username];
      
      if (!user) {
        showNotification('ç”¨æˆ·ä¸å­˜åœ¨', 'error');
        return;
      }

      if (btoa(password) !== user.password) {
        showNotification('å¯†ç é”™è¯¯', 'error');
        return;
      }

      loginUser(username);
      hideAuthModal();
      showNotification(`ğŸ¬ æ¬¢è¿å›æ¥ï¼Œ${username}ï¼`, 'success');
    }

    function loginUser(username) {
      currentUser = { ...userDatabase[username] };
      updateUI();
      renderVideoGrid();
    }

    function logout() {
      currentUser = null;
      updateUI();
      renderVideoGrid();
      showNotification('å·²å®‰å…¨é€€å‡ºç™»å½•', 'success');
    }

    function updateUI() {
      if (currentUser) {
        document.getElementById('usernameDisplay').textContent = currentUser.username;
        document.getElementById('coinsDisplay').textContent = currentUser.coins;
        document.getElementById('loginBtn').style.display = 'none';
        document.getElementById('personalBtn').style.display = 'inline-block';
        document.getElementById('logoutBtn').style.display = 'inline-block';
        
        document.getElementById('accountUsername').textContent = currentUser.username;
        document.getElementById('accountCoins').textContent = currentUser.coins;
        document.getElementById('accountDate').textContent = currentUser.joinDate;
        document.getElementById('generatedVideos').textContent = currentUser.generatedVideos || 0;
      } else {
        document.getElementById('usernameDisplay').textContent = 'æ¸¸å®¢';
        document.getElementById('coinsDisplay').textContent = '0';
        document.getElementById('loginBtn').style.display = 'inline-block';
        document.getElementById('personalBtn').style.display = 'none';
        document.getElementById('logoutBtn').style.display = 'none';
        document.getElementById('personalSection').style.display = 'none';
      }
    }

    // ==================== AIè§†é¢‘ç”Ÿæˆ ====================
    function setPrompt(prompt) {
      document.getElementById('aiPrompt').value = prompt;
      document.getElementById('aiPrompt').focus();
    }

    // æµ‹è¯•è§†é¢‘æºæ˜¯å¦å¯ç”¨
    function testVideoSource(url) {
      return new Promise((resolve) => {
        const video = document.createElement('video');
        video.preload = 'metadata';
        
        video.onloadedmetadata = function() {
          resolve(true);
        };
        
        video.onerror = function() {
          resolve(false);
        };
        
        video.src = url;
      });
    }

    // è·å–å¯ç”¨çš„è§†é¢‘æº
    async function getAvailableVideoSource() {
      // å…ˆå°è¯•ä½¿ç”¨ä¸»æº
      for (let i = 0; i < backupVideoSources.length; i++) {
        const isAvailable = await testVideoSource(backupVideoSources[i]);
        if (isAvailable) {
          return backupVideoSources[i];
        }
      }
      
      // å¦‚æœéƒ½æ²¡æœ‰ï¼Œè¿”å›ç¬¬ä¸€ä¸ªä½œä¸ºå¤‡é€‰
      return backupVideoSources[0];
    }

    async function generateAIVideo() {
      console.log('å¼€å§‹AIè§†é¢‘ç”Ÿæˆ...');
      
      if (!currentUser) {
        showNotification('è¯·å…ˆç™»å½•æ‰èƒ½ä½¿ç”¨AIç”ŸæˆåŠŸèƒ½', 'error');
        showAuthModal();
        return;
      }
      
      const prompt = document.getElementById('aiPrompt').value.trim();
      if (!prompt) {
        showNotification('è¯·è¾“å…¥è§†é¢‘æè¿°', 'error');
        return;
      }
      
      if (currentUser.coins < 10) {
        showNotification('ç”Ÿæˆå¸ä¸è¶³ï¼Œè¯·å……å€¼åå†è¯•', 'error');
        showPersonal();
        return;
      }
      
      currentUser.coins -= 10;
      userDatabase[currentUser.username].coins = currentUser.coins;
      userDatabase[currentUser.username].generatedVideos = (userDatabase[currentUser.username].generatedVideos || 0) + 1;
      generatedVideosCount[currentUser.username] = (generatedVideosCount[currentUser.username] || 0) + 1;
      
      localStorage.setItem('videoUsers', JSON.stringify(userDatabase));
      localStorage.setItem('generatedVideos', JSON.stringify(generatedVideosCount));
      
      updateUI();
      
      document.getElementById('loading').style.display = 'block';
      document.getElementById('aiVideoPreview').style.display = 'none';
      
      document.getElementById('step1').textContent = 'æ­£åœ¨åˆ†æ...';
      document.getElementById('step2').textContent = 'æ­£åœ¨åŒ¹é…...';
      document.getElementById('step3').textContent = 'æ­£åœ¨ç”Ÿæˆ...';
      
      setTimeout(async () => {
        document.getElementById('step1').textContent = `"${prompt}"`;
        
        setTimeout(async () => {
          const promptLower = prompt.toLowerCase();
          let matchedCategory = 'åŠ¨ç”»';
          let matchedKeywords = [];
          
          if (promptLower.includes('è‡ªç„¶') || promptLower.includes('é£æ™¯') || promptLower.includes('å±±æ°´') || 
              promptLower.includes('æ£®æ—') || promptLower.includes('æµ·æ´‹') || promptLower.includes('å±±è„‰')) {
            matchedCategory = 'è‡ªç„¶';
            matchedKeywords = ['è‡ªç„¶', 'é£æ™¯', 'å±±æ°´'];
          } else if (promptLower.includes('åŸå¸‚') || promptLower.includes('å»ºç­‘') || promptLower.includes('éƒ½å¸‚') || 
                    promptLower.includes('å¤œæ™¯') || promptLower.includes('è¡—é“') || promptLower.includes('é«˜æ¥¼')) {
            matchedCategory = 'åŸå¸‚';
            matchedKeywords = ['åŸå¸‚', 'å»ºç­‘', 'å¤œæ™¯'];
          } else if (promptLower.includes('ç§‘æŠ€') || promptLower.includes('æœªæ¥') || promptLower.includes('ç§‘å¹»') || 
                    promptLower.includes('AI') || promptLower.includes('æ™ºèƒ½') || promptLower.includes('æ•°å­—')) {
            matchedCategory = 'ç§‘æŠ€';
            matchedKeywords = ['ç§‘æŠ€', 'æœªæ¥', 'æ™ºèƒ½'];
          } else if (promptLower.includes('åŠ¨ç‰©') || promptLower.includes('å® ç‰©') || promptLower.includes('çŒ«') || 
                    promptLower.includes('ç‹—') || promptLower.includes('é¸Ÿç±»') || promptLower.includes('é‡ç”ŸåŠ¨ç‰©')) {
            matchedCategory = 'åŠ¨ç‰©';
            matchedKeywords = ['åŠ¨ç‰©', 'å® ç‰©', 'å¯çˆ±'];
          } else if (promptLower.includes('åŠ¨ç”»') || promptLower.includes('å¡é€š') || promptLower.includes('åŠ¨æ¼«') || 
                    promptLower.includes('æ¼«ç”»') || promptLower.includes('å¹»æƒ³') || promptLower.includes('ç«¥è¯')) {
            matchedCategory = 'åŠ¨ç”»';
            matchedKeywords = ['åŠ¨ç”»', 'å¡é€š', 'å¹»æƒ³'];
          }
          
          document.getElementById('step2').textContent = `${matchedCategory}ç±»è§†é¢‘`;
          
          setTimeout(async () => {
            document.getElementById('step3').textContent = 'ç”Ÿæˆå®Œæˆï¼';
            
            // ä»å¯¹åº”åˆ†ç±»ä¸­éšæœºé€‰æ‹©è§†é¢‘
            const categoryVideos = aiVideoLibrary[matchedCategory] || aiVideoLibrary['åŠ¨ç”»'];
            const randomIndex = Math.floor(Math.random() * categoryVideos.length);
            const selectedVideo = categoryVideos[randomIndex];
            
            console.log(`AIç”Ÿæˆ: æç¤ºè¯"${prompt}" â†’ åŒ¹é…åˆ†ç±»"${matchedCategory}" â†’ è§†é¢‘"${selectedVideo.title}"`);
            
            document.getElementById('loading').style.display = 'none';
            
            // æ›´æ–°æ˜¾ç¤ºä¿¡æ¯
            document.getElementById('aiVideoCategory').textContent = matchedCategory;
            document.getElementById('aiMatchedKeywords').textContent = matchedKeywords.join('ã€');
            document.getElementById('aiVideoDuration').textContent = selectedVideo.duration;
            document.getElementById('aiGeneratedTime').textContent = new Date().toLocaleTimeString('zh-CN', { 
              hour: '2-digit', 
              minute: '2-digit' 
            });
            
            // å‡†å¤‡è§†é¢‘å®¹å™¨
            const videoContainer = document.getElementById('aiVideoContainer');
            const videoElement = document.getElementById('aiGeneratedVideo');
            
            // æµ‹è¯•è§†é¢‘æºæ˜¯å¦å¯ç”¨
            const videoUrl = selectedVideo.url;
            const isVideoAvailable = await testVideoSource(videoUrl);
            
            if (!isVideoAvailable) {
              // å¦‚æœè§†é¢‘ä¸å¯ç”¨ï¼Œä½¿ç”¨å¤‡é€‰æº
              const backupUrl = await getAvailableVideoSource();
              videoElement.src = backupUrl;
              showNotification('ä½¿ç”¨å¤‡é€‰è§†é¢‘æºæ’­æ”¾', 'warning');
            } else {
              videoElement.src = videoUrl;
            }
            
            // ç›‘å¬è§†é¢‘é”™è¯¯
            videoElement.onerror = function() {
              console.error('è§†é¢‘åŠ è½½å¤±è´¥:', videoElement.src);
              showVideoError('è§†é¢‘æºå¯èƒ½æ— æ³•è®¿é—®ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–ä½¿ç”¨æœ¬åœ°è§†é¢‘');
            };
            
            videoElement.load();
            
            // æ˜¾ç¤ºè§†é¢‘é¢„è§ˆ
            document.getElementById('aiVideoPreview').style.display = 'block';
            
            document.getElementById('aiVideoPreview').scrollIntoView({ 
              behavior: 'smooth', 
              block: 'nearest' 
            });
            
            showNotification(`ğŸ¬ AIå·²ç”Ÿæˆ${matchedCategory}ç±»è§†é¢‘: ${selectedVideo.title}`, 'success');
            
            document.getElementById('aiPrompt').value = '';
            
            // ä¿å­˜ç”Ÿæˆçš„è§†é¢‘è®°å½•
            const generatedVideo = {
              url: videoElement.src,
              title: selectedVideo.title,
              desc: selectedVideo.desc + ' (AIç”Ÿæˆ)',
              duration: selectedVideo.duration,
              category: matchedCategory + ' (AIç”Ÿæˆ)',
              size: 'AIç”Ÿæˆ',
              isAIGenerated: true,
              generatedTime: new Date().toLocaleString('zh-CN'),
              prompt: prompt
            };
            
            userLocalVideos.unshift(generatedVideo);
            localStorage.setItem('userLocalVideos', JSON.stringify(userLocalVideos));
            
          }, 1000);
          
        }, 800);
        
      }, 500);
    }

    // ==================== æœ¬åœ°è§†é¢‘ç®¡ç† ====================
    function addLocalVideo() {
      if (!currentUser) {
        showNotification('è¯·å…ˆç™»å½•æ‰èƒ½ä¸Šä¼ æœ¬åœ°è§†é¢‘', 'error');
        showAuthModal();
        return;
      }
      
      const fileInput = document.createElement('input');
      fileInput.type = 'file';
      fileInput.accept = 'video/*';
      fileInput.multiple = true;
      
      fileInput.onchange = function(e) {
        const files = e.target.files;
        if (files.length === 0) return;
        
        const maxSize = 100 * 1024 * 1024;
        let validFiles = [];
        
        Array.from(files).forEach(file => {
          if (file.size > maxSize) {
            showNotification(`æ–‡ä»¶ ${file.name} å¤ªå¤§ï¼Œæœ€å¤§æ”¯æŒ100MB`, 'error');
            return;
          }
          
          if (!file.type.includes('video/')) {
            showNotification(`æ–‡ä»¶ ${file.name} ä¸æ˜¯è§†é¢‘æ ¼å¼`, 'error');
            return;
          }
          
          validFiles.push(file);
        });
        
        if (validFiles.length === 0) return;
        
        validFiles.forEach((file, index) => {
          const videoUrl = URL.createObjectURL(file);
          
          const videoObj = {
            url: videoUrl,
            title: file.name.replace(/\.[^/.]+$/, ""),
            desc: 'ç”¨æˆ·ä¸Šä¼ çš„æœ¬åœ°è§†é¢‘ - ' + file.name,
            duration: 'æœªçŸ¥',
            category: 'æˆ‘çš„è§†é¢‘',
            size: formatFileSize(file.size),
            uploadDate: new Date().toLocaleDateString('zh-CN'),
            uploader: currentUser.username,
            isUserUploaded: true
          };
          
          userLocalVideos.push(videoObj);
        });
        
        localStorage.setItem('userLocalVideos', JSON.stringify(userLocalVideos));
        
        showNotification(`æˆåŠŸä¸Šä¼  ${validFiles.length} ä¸ªæœ¬åœ°è§†é¢‘`, 'success');
        renderVideoGrid();
      };
      
      fileInput.click();
    }
    
    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    // ==================== è§†é¢‘ç½‘æ ¼æ¸²æŸ“ ====================
    function renderVideoGrid() {
      const videoGrid = document.getElementById('videoGrid');
      videoGrid.innerHTML = '';
      
      let allVideos = [];
      
      Object.values(videoLibrary).forEach(category => {
        allVideos = allVideos.concat(category);
      });
      
      allVideos = allVideos.concat(userLocalVideos);
      
      if (allVideos.length === 0) {
        videoGrid.innerHTML = `
          <div style="grid-column: 1 / -1; text-align: center; padding: 50px; color: var(--text-muted);">
            <i class="fas fa-video-slash" style="font-size: 48px; margin-bottom: 20px;"></i>
            <h3>æš‚æ— æœ¬åœ°è§†é¢‘</h3>
            <p>è¯·ç‚¹å‡»ä¸Šæ–¹"ä¸Šä¼ è§†é¢‘"æŒ‰é’®æ·»åŠ æœ¬åœ°è§†é¢‘æ–‡ä»¶</p>
            <p style="font-size: 12px; margin-top: 10px;">æ”¯æŒçš„æ ¼å¼: MP4, WebM, MOV</p>
            <p style="font-size: 12px;">æœ€å¤§æ–‡ä»¶å¤§å°: 100MB</p>
          </div>
        `;
        return;
      }
      
      allVideos.forEach(video => {
        const videoCard = document.createElement('div');
        videoCard.className = 'video-card';
        videoCard.onclick = () => playVideo(video.url, video.title);
        
        const thumbnailSrc = `https://picsum.photos/320/200?random=${Math.random()}`;
        
        videoCard.innerHTML = `
          <div class="thumbnail-container">
            <img src="${thumbnailSrc}" 
                 class="thumbnail" 
                 alt="${video.title}"
                 onerror="this.src='https://picsum.photos/320/200?random=${Math.random()}'">
            <div class="play-overlay">
              <div class="play-icon">
                <i class="fas fa-play"></i>
              </div>
            </div>
            <div style="position:absolute; bottom:10px; right:10px; background:rgba(0,0,0,0.7); color:white; padding:2px 8px; border-radius:4px; font-size:12px;">
              ${video.duration}
            </div>
            ${video.isUserUploaded ? `
              <div style="position:absolute; top:10px; left:10px; background:rgba(255,107,0,0.9); color:white; padding:2px 8px; border-radius:4px; font-size:10px; font-weight:bold;">
                æˆ‘çš„
              </div>
            ` : ''}
            ${video.isAIGenerated ? `
              <div style="position:absolute; top:10px; left:10px; background:rgba(74,144,226,0.9); color:white; padding:2px 8px; border-radius:4px; font-size:10px; font-weight:bold;">
                AI
              </div>
            ` : ''}
          </div>
          <div class="video-info">
            <h4>${video.title}</h4>
            <p>${video.desc}</p>
            <div class="video-meta">
              <span><i class="fas fa-tag"></i> ${video.category}</span>
              <span><i class="fas fa-hdd"></i> ${video.size || ''}</span>
            </div>
            ${video.uploadDate || video.generatedTime ? `
              <div style="font-size:11px; color:var(--text-muted); margin-top:8px;">
                <i class="fas fa-calendar"></i> ${video.uploadDate || video.generatedTime}
                ${video.uploader ? ` | <i class="fas fa-user"></i> ${video.uploader}` : ''}
              </div>
            ` : ''}
          </div>
        `;
        
        videoGrid.appendChild(videoCard);
      });
    }

    function refreshVideos() {
      renderVideoGrid();
      showNotification('å·²åˆ·æ–°è§†é¢‘åˆ—è¡¨', 'success');
    }

    // ==================== ä¸ªäººç©ºé—´ ====================
    function showPersonal() {
      if (!currentUser) {
        showNotification('è¯·å…ˆç™»å½•', 'error');
        return;
      }
      
      document.getElementById('personalSection').style.display = 'block';
      
      document.getElementById('accountUsername').textContent = currentUser.username;
      document.getElementById('accountCoins').textContent = currentUser.coins;
      document.getElementById('accountDate').textContent = currentUser.joinDate;
      document.getElementById('generatedVideos').textContent = currentUser.generatedVideos || 0;
      
      document.getElementById('personalSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function hidePersonal() {
      document.getElementById('personalSection').style.display = 'none';
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function addCoins(amount) {
      if (!currentUser) {
        showNotification('è¯·å…ˆç™»å½•', 'error');
        return;
      }
      
      const prices = {10: 10, 50: 45, 100: 80};
      const price = prices[amount];
      
      if (confirm(`ç¡®è®¤è´­ä¹° ${amount} ç”Ÿæˆå¸ï¼Œä»·æ ¼ Â¥${price}ï¼Ÿ`)) {
        currentUser.coins += amount;
        userDatabase[currentUser.username].coins = currentUser.coins;
        localStorage.setItem('videoUsers', JSON.stringify(userDatabase));
        updateUI();
        showNotification(`ğŸ‰ æˆåŠŸè´­ä¹° ${amount} ç”Ÿæˆå¸ï¼`, 'success');
      }
    }

    // ==================== è§†é¢‘æ’­æ”¾ ====================
    function playVideo(url, title) {
      const player = document.getElementById('videoPlayer');
      const video = document.getElementById('playerVideo');
      
      video.src = url;
      video.load();
      player.style.display = 'flex';
      
      setTimeout(() => {
        video.play().catch(e => console.log('è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢:', e));
      }, 300);
      
      // ç›‘å¬è§†é¢‘é”™è¯¯
      video.onerror = function() {
        console.error('è§†é¢‘æ’­æ”¾å¤±è´¥:', url);
        showNotification('è§†é¢‘æ’­æ”¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥è§†é¢‘æº', 'error');
      };
    }

    function closeVideo() {
      const player = document.getElementById('videoPlayer');
      const video = document.getElementById('playerVideo');
      
      video.pause();
      video.src = '';
      player.style.display = 'none';
    }

    // ==================== ç²’å­èƒŒæ™¯ ====================
    function initParticles() {
      const particlesContainer = document.getElementById('particles');
      const particleCount = 30;
      
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.style.position = 'absolute';
        particle.style.width = Math.random() * 4 + 1 + 'px';
        particle.style.height = particle.style.width;
        particle.style.background = `rgba(255, 107, 0, ${Math.random() * 0.3 + 0.1})`;
        particle.style.borderRadius = '50%';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.top = Math.random() * 100 + '%';
        particle.style.boxShadow = '0 0 10px rgba(255, 107, 0, 0.5)';
        
        particlesContainer.appendChild(particle);
        
        animateParticle(particle);
      }
    }

    function animateParticle(particle) {
      let x = parseFloat(particle.style.left);
      let y = parseFloat(particle.style.top);
      let dx = (Math.random() - 0.5) * 0.3;
      let dy = (Math.random() - 0.5) * 0.3;
      
      function move() {
        x += dx;
        y += dy;
        
        if (x < 0 || x > 100) dx = -dx;
        if (y < 0 || y > 100) dy = -dy;
        
        particle.style.left = x + '%';
        particle.style.top = y + '%';
        
        requestAnimationFrame(move);
      }
      
      move();
    }

    // ==================== åˆå§‹åŒ– ====================
    document.addEventListener('DOMContentLoaded', () => {
      console.log('ğŸ¬ çº¯å‰ç«¯AIè§†é¢‘å¹³å°å·²åŠ è½½');
      
      initParticles();
      
      if (!userDatabase['test']) {
        userDatabase['test'] = {
          username: 'test',
          password: btoa('123456'),
          coins: 200,
          joinDate: new Date().toLocaleDateString('zh-CN'),
          generatedVideos: 3
        };
        generatedVideosCount['test'] = 3;
        localStorage.setItem('videoUsers', JSON.stringify(userDatabase));
        localStorage.setItem('generatedVideos', JSON.stringify(generatedVideosCount));
      }
      
      generatedVideosCount = JSON.parse(localStorage.getItem('generatedVideos')) || {};
      userLocalVideos = JSON.parse(localStorage.getItem('userLocalVideos')) || [];
      
      updateUI();
      renderVideoGrid();
      
      const examples = [
        'åŠ¨ç”»ç”µå½±ï¼Œå¯çˆ±åŠ¨ç‰©å†’é™©æ•…äº‹',
        'è‡ªç„¶é£å…‰ï¼Œå±±æ°´å¦‚ç”»çš„é£æ™¯',
        'æœªæ¥åŸå¸‚ï¼Œç§‘æŠ€æ„Ÿåè¶³çš„å»ºç­‘',
        'åŠ¨ç‰©ä¸–ç•Œï¼Œå¯çˆ±å® ç‰©æ—¥å¸¸',
        'ç§‘å¹»åœºæ™¯ï¼Œæœºå™¨äººæœªæ¥ä¸–ç•Œ',
        'åŸå¸‚å¤œæ™¯ï¼Œç¯ç«è¾‰ç…Œçš„è¡—é“'
      ];
      
      const promptInput = document.getElementById('aiPrompt');
      let exampleIndex = 0;
      
      setInterval(() => {
        promptInput.placeholder = `ä¾‹å¦‚ï¼š${examples[exampleIndex]}`;
        exampleIndex = (exampleIndex + 1) % examples.length;
      }, 3000);
      
      document.getElementById('authModal').addEventListener('click', function(e) {
        if (e.target === this) hideAuthModal();
      });
      
      promptInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') generateAIVideo();
      });
      
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') closeVideo();
      });
    });
  </script>
</body>
</html>